!function(){"use strict";var e=class{constructor(e,t){this._inputSelector=e.inputSelector,this._submitButtonSelector=e.submitButtonSelector,this._inactiveButtonClass=e.inactiveButtonClass,this._inputErrorClass=e.inputErrorClass,this._errorClass=e.errorClass,this._form=t}_showInputError(e){const t=this._form.querySelector(`#${e.id}-error`);e.classList.add(this._inputErrorClass),t.textContent=e.validationMessage,t.classList.add(this._errorClass)}_hideInputError(e){const t=this._form.querySelector(`#${e.id}-error`);e.classList.remove(this._inputErrorClass),t.textContent="",t.classList.remove(this._errorClass)}_toggleButtonState(){return this._hasInvalidInput(this._inputEls)?this.disableButton():this.enableButton()}_hasInvalidInput(e){return!e.every((e=>e.validity.valid))}disableButton(){this._submitButton.classList.add(this._inactiveButtonClass),this._submitButton.disabled=!0}enableButton(){this._submitButton.classList.remove(this._inactiveButtonClass),this._submitButton.disabled=!1}_checkInputValidity(e){if(!e.validity.valid)return this._showInputError(e);this._hideInputError(e)}_setEventListeners(){this._inputEls=[...this._form.querySelectorAll(this._inputSelector)],this._submitButton=this._form.querySelector(this._submitButtonSelector),this._inputEls.forEach((e=>{e.addEventListener("input",(t=>{this._checkInputValidity(e),this._toggleButtonState(this._inputEls,this._submitButton)}))}))}enableValidation(){this._form.addEventListener("submit",(e=>{e.preventDefault()})),this._setEventListeners()}};const t=[{name:"Yosemite Valley",link:"https://code.s3.yandex.net/web-code/yosemite.jpg"},{name:"Lake Louise",link:"https://code.s3.yandex.net/web-code/lake-louise.jpg"},{name:"Bald Mountains",link:"https://code.s3.yandex.net/web-code/bald-mountains.jpg"},{name:"Latemar",link:"https://code.s3.yandex.net/web-code/latemar.jpg"},{name:"Vanoise National Park",link:"https://code.s3.yandex.net/web-code/vanoise.jpg"},{name:"Lago di Braies",link:"https://code.s3.yandex.net/web-code/lago.jpg "}],s={inputSelector:".popup__input",submitButtonSelector:".popup__button",inactiveButtonClass:"popup__button_disabled",inputErrorClass:"popup__input_type_error",errorClass:"popup__error_visible"},n=".card-list",i="#image_preview",o="#edit-popup",r="#add-popup";class l{constructor(e){this._popupElement=document.querySelector(e),this._handleEscPress=this._handleEscPress.bind(this),this._handleOverlay=this._handleOverlay.bind(this),this._closeButton=this._popupElement.querySelector(".popup__close"),this.closePopup=this.closePopup.bind(this)}openPopup(){this._popupElement.classList.add("popup_is-opened"),this.setEventsListeners()}closePopup(){this._popupElement.classList.remove("popup_is-opened"),this.removeEventsListeners()}setEventsListeners(){this._closeButton.addEventListener("click",this.closePopup),document.addEventListener("keydown",this._handleEscPress),this._popupElement.addEventListener("mousedown",this._handleOverlay)}removeEventsListeners(){this._closeButton.removeEventListener("click",this.closePopup),document.removeEventListener("keydown",this._handleEscPress),this._popupElement.removeEventListener("mousedown",this._handleOverlay)}_handleEscPress(e){"Escape"===e.key&&this.closePopup()}_handleOverlay(e){e.target.classList.contains("popup")&&this.closePopup()}}class u extends l{constructor(e){let{popupSelector:t,handleFormSubmit:s}=e;var n,i;super(t),i=e=>{e.preventDefault(),this._handleFormSubmit(this._getInputValues())},(n="handleSubmit")in this?Object.defineProperty(this,n,{value:i,enumerable:!0,configurable:!0,writable:!0}):this[n]=i,this._popupForm=this._popupElement.querySelector(".popup__form"),this._inputList=this._popupForm.querySelectorAll(".popup__input"),this._handleFormSubmit=s}_getInputValues(){const e={};return this._inputList.forEach((t=>e[t.name]=t.value)),e}setEventsListeners(){super.setEventsListeners(),this._popupForm.addEventListener("submit",this.handleSubmit)}removeEventsListeners(){super.removeEventsListeners(),this._popupForm.removeEventListener("submit",this.handleSubmit)}closePopup(){this._popupForm.reset(),super.closePopup()}}const p=document.querySelector(".profile__edit-button"),a=(document.querySelector("#edit_close-button"),document.querySelector("#edit-profile-form")),c=a.querySelector(".popup__input_type_name"),_=(document.querySelector(i),a.querySelector(".popup__input_type_description")),d=(document.querySelector(".profile__title"),document.querySelector(".profile__description"),document.querySelector(o),document.querySelector(n));document.querySelector(r),document.querySelector("#image_preview-close").addEventListener("click",(function(){m.closePopup()})),p.addEventListener("click",(()=>{const{name:e,description:t}=h.getUserInfo();c.value=e,_.value=t,b.openPopup()}));const h=new class{constructor(e,t){this._userNameElement=document.querySelector(e),this._userDescriptionElement=document.querySelector(t)}getUserInfo(){return{name:this._userNameElement.textContent,description:this._userDescriptionElement.textContent}}setUserInfo(e){let{title:t,description:s}=e;this._userNameElement.textContent=t,this._userDescriptionElement.textContent=s}}(".profile__title",".profile__description"),m=new class extends l{constructor(e){super(e),this._imageElement=this._popupElement.querySelector(".popup__image"),this._imageCaption=this._popupElement.querySelector(".popup__image-title")}open(e){let{link:t,title:s}=e;this._imageElement.src=t,this._imageElement.alt=`Image of ${s}`,this._imageCaption.textContent=s,super.openPopup()}}(i),v=new class{constructor(e,t){let{items:s,renderer:n}=e;this._renderer=n,this._container=document.querySelector(t)}renderItems(e){e.forEach((e=>{this._renderer(e)}))}addItem(e){this._container.prepend(e)}}({items:t,renderer:g},n),E=document.querySelector("#add-profile-form"),y=new e(s,a);y.enableValidation();const S=new e(s,E);S.enableValidation();const b=new u({popupSelector:o,handleFormSubmit:e=>{h.setUserInfo(e),b.closePopup(),y.disableButton()}});b.setEventsListeners();const L=new u({popupSelector:r,handleFormSubmit:e=>{v.addItem(q(e).getView()),L.closePopup(),S.disableButton()}});function g(e,t){t.prepend(e.getView())}t.reverse().forEach((e=>{g(q(e),d)}));const f=document.querySelector("#add_close-button");function q(e){return new class{constructor(e,t,s){this._name=e.name,this._link=e.link,this._cardSelector=t,this._handleImageClick=s}_setEventListeners(){this._element.querySelector(".card__button").addEventListener("click",(()=>this._handleLikeButton())),this._element.querySelector(".card__trash").addEventListener("click",(()=>this._handleDeleteCard())),this._element.querySelector(".card__image").addEventListener("click",(()=>this._handleImageClick(this._link,this._name)))}_handleLikeButton(){this._element.querySelector(".card__button").classList.toggle("card__button_active")}_handleDeleteCard(){this._element.remove(),this._element=null}_getTemplate(){return document.querySelector(this._cardSelector).content.querySelector(".card").cloneNode(!0)}getView(){this._element=this._getTemplate();const e=this._element.querySelector(".card__image");return e.src=this._link,e.alt=`Image of ${this._name}`,this._element.querySelector(".card__text").textContent=this._name,this._setEventListeners(),this._element}}(e,"#card-template",((e,t)=>{m.open({link:e,title:t})}))}document.querySelector(".profile__add-button").addEventListener("click",(function(){L.openPopup()})),f.addEventListener("click",(function(){L.closePopup()}))}();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoibWFpbi5qcyIsIm1hcHBpbmdzIjoieUJBdUVBLE1BdkVBLE1BQ0VBLFlBQVlDLEVBQW9CQyxHQUM5QkMsS0FBS0MsZUFBaUJILEVBQW1CSSxjQUN6Q0YsS0FBS0csc0JBQXdCTCxFQUFtQk0scUJBQ2hESixLQUFLSyxxQkFBdUJQLEVBQW1CUSxvQkFDL0NOLEtBQUtPLGlCQUFtQlQsRUFBbUJVLGdCQUMzQ1IsS0FBS1MsWUFBY1gsRUFBbUJZLFdBQ3RDVixLQUFLVyxNQUFRWixDQUNmLENBRUFhLGdCQUFnQkMsR0FDZCxNQUFNQyxFQUFrQmQsS0FBS1csTUFBTUksY0FBZSxJQUFHRixFQUFRRyxZQUM3REgsRUFBUUksVUFBVUMsSUFBSWxCLEtBQUtPLGtCQUMzQk8sRUFBZ0JLLFlBQWNOLEVBQVFPLGtCQUN0Q04sRUFBZ0JHLFVBQVVDLElBQUlsQixLQUFLUyxZQUNyQyxDQUNBWSxnQkFBZ0JSLEdBQ2QsTUFBTUMsRUFBa0JkLEtBQUtXLE1BQU1JLGNBQWUsSUFBR0YsRUFBUUcsWUFDN0RILEVBQVFJLFVBQVVLLE9BQU90QixLQUFLTyxrQkFDOUJPLEVBQWdCSyxZQUFjLEdBQzlCTCxFQUFnQkcsVUFBVUssT0FBT3RCLEtBQUtTLFlBQ3hDLENBR0FjLHFCQUNFLE9BQUl2QixLQUFLd0IsaUJBQWlCeEIsS0FBS3lCLFdBQ3RCekIsS0FBSzBCLGdCQUVQMUIsS0FBSzJCLGNBQ2QsQ0FHQUgsaUJBQWlCSSxHQUNmLE9BQVFBLEVBQVVDLE9BQU9oQixHQUFZQSxFQUFRaUIsU0FBU0MsT0FDeEQsQ0FDQUwsZ0JBQ0UxQixLQUFLZ0MsY0FBY2YsVUFBVUMsSUFBSWxCLEtBQUtLLHNCQUN0Q0wsS0FBS2dDLGNBQWNDLFVBQVcsQ0FDaEMsQ0FFQU4sZUFDRTNCLEtBQUtnQyxjQUFjZixVQUFVSyxPQUFPdEIsS0FBS0ssc0JBQ3pDTCxLQUFLZ0MsY0FBY0MsVUFBVyxDQUNoQyxDQUVBQyxvQkFBb0JyQixHQUNsQixJQUFLQSxFQUFRaUIsU0FBU0MsTUFDcEIsT0FBTy9CLEtBQUtZLGdCQUFnQkMsR0FFOUJiLEtBQUtxQixnQkFBZ0JSLEVBQ3ZCLENBRUFzQixxQkFDRW5DLEtBQUt5QixVQUFZLElBQUl6QixLQUFLVyxNQUFNeUIsaUJBQWlCcEMsS0FBS0MsaUJBQ3RERCxLQUFLZ0MsY0FBZ0JoQyxLQUFLVyxNQUFNSSxjQUFjZixLQUFLRyx1QkFDbkRILEtBQUt5QixVQUFVWSxTQUFTeEIsSUFDdEJBLEVBQVF5QixpQkFBaUIsU0FBVUMsSUFDakN2QyxLQUFLa0Msb0JBQW9CckIsR0FDekJiLEtBQUt1QixtQkFBbUJ2QixLQUFLeUIsVUFBV3pCLEtBQUtnQyxjQUFjLEdBQzNELEdBRU4sQ0FFQVEsbUJBQ0V4QyxLQUFLVyxNQUFNMkIsaUJBQWlCLFVBQVdDLElBQ3JDQSxFQUFFRSxnQkFBZ0IsSUFFcEJ6QyxLQUFLbUMsb0JBQ1AsR0NwRUssTUFBTU8sRUFBZSxDQUMxQixDQUNFQyxLQUFNLGtCQUNOQyxLQUFNLG9EQUVSLENBQ0VELEtBQU0sY0FDTkMsS0FBTSx1REFFUixDQUNFRCxLQUFNLGlCQUNOQyxLQUFNLDBEQUVSLENBQ0VELEtBQU0sVUFDTkMsS0FBTSxtREFFUixDQUNFRCxLQUFNLHdCQUNOQyxLQUFNLG1EQUVSLENBQ0VELEtBQU0saUJBQ05DLEtBQU0sa0RBSUc5QyxFQUFxQixDQUNoQ0ksY0FBZSxnQkFDZkUscUJBQXNCLGlCQUN0QkUsb0JBQXFCLHlCQUNyQkUsZ0JBQWlCLDBCQUNqQkUsV0FBWSx3QkFHRG1DLEVBQ0MsYUFEREEsRUFHRyxpQkFISEEsRUFRQSxjQVJBQSxFQVNELGFDNUNHLE1BQU1DLEVBQ25CakQsWUFBWWtELEdBQ1YvQyxLQUFLZ0QsY0FBZ0JDLFNBQVNsQyxjQUFjZ0MsR0FDNUMvQyxLQUFLa0QsZ0JBQWtCbEQsS0FBS2tELGdCQUFnQkMsS0FBS25ELE1BQ2pEQSxLQUFLb0QsZUFBaUJwRCxLQUFLb0QsZUFBZUQsS0FBS25ELE1BQy9DQSxLQUFLcUQsYUFBZXJELEtBQUtnRCxjQUFjakMsY0FBYyxpQkFDckRmLEtBQUtzRCxXQUFhdEQsS0FBS3NELFdBQVdILEtBQUtuRCxLQUN6QyxDQUVBdUQsWUFDRXZELEtBQUtnRCxjQUFjL0IsVUFBVUMsSUFBSSxtQkFDakNsQixLQUFLd0Qsb0JBQ1AsQ0FFQUYsYUFDRXRELEtBQUtnRCxjQUFjL0IsVUFBVUssT0FBTyxtQkFDcEN0QixLQUFLeUQsdUJBQ1AsQ0FFQUQscUJBQ0V4RCxLQUFLcUQsYUFBYWYsaUJBQWlCLFFBQVN0QyxLQUFLc0QsWUFDakRMLFNBQVNYLGlCQUFpQixVQUFXdEMsS0FBS2tELGlCQUMxQ2xELEtBQUtnRCxjQUFjVixpQkFBaUIsWUFBYXRDLEtBQUtvRCxlQUN4RCxDQUVBSyx3QkFDRXpELEtBQUtxRCxhQUFhSyxvQkFBb0IsUUFBUzFELEtBQUtzRCxZQUNwREwsU0FBU1Msb0JBQW9CLFVBQVcxRCxLQUFLa0QsaUJBQzdDbEQsS0FBS2dELGNBQWNVLG9CQUFvQixZQUFhMUQsS0FBS29ELGVBQzNELENBRUFGLGdCQUFnQlgsR0FDQSxXQUFWQSxFQUFFb0IsS0FDSjNELEtBQUtzRCxZQUVULENBRUFGLGVBQWViLEdBQ1RBLEVBQUVxQixPQUFPM0MsVUFBVTRDLFNBQVMsVUFDOUI3RCxLQUFLc0QsWUFFVCxFQ3ZDYSxNQUFNUSxVQUFzQmhCLEVBQ3pDakQsWUFBWSxHQUFxQyxJQUFyQyxjQUFFa0QsRUFBYSxpQkFBRWdCLEdBQWtCLEUsUUFDN0NDLE1BQU1qQixHLEVBYVFSLElBQ2RBLEVBQUVFLGlCQUNGekMsS0FBS2lFLGtCQUFrQmpFLEtBQUtrRSxrQkFBa0IsRyxFQWZ6Qix1QixzQkFBQSxLLHVEQUFBLEssS0FFckJsRSxLQUFLbUUsV0FBYW5FLEtBQUtnRCxjQUFjakMsY0FBYyxnQkFDbkRmLEtBQUtvRSxXQUFhcEUsS0FBS21FLFdBQVcvQixpQkFBaUIsaUJBQ25EcEMsS0FBS2lFLGtCQUFvQkYsQ0FDM0IsQ0FFQUcsa0JBQ0UsTUFBTUcsRUFBYyxDQUFDLEVBRXJCLE9BREFyRSxLQUFLb0UsV0FBVy9CLFNBQVNpQyxHQUFXRCxFQUFZQyxFQUFNM0IsTUFBUTJCLEVBQU1DLFFBQzdERixDQUNULENBT0FiLHFCQUNFUSxNQUFNUixxQkFDTnhELEtBQUttRSxXQUFXN0IsaUJBQWlCLFNBQVV0QyxLQUFLd0UsYUFDbEQsQ0FFQWYsd0JBQ0VPLE1BQU1QLHdCQUNOekQsS0FBS21FLFdBQVdULG9CQUFvQixTQUFVMUQsS0FBS3dFLGFBQ3JELENBRUFsQixhQUNFdEQsS0FBS21FLFdBQVdNLFFBQ2hCVCxNQUFNVixZQUNSLEVDbkJGLE1BQU1vQixFQUFvQnpCLFNBQVNsQyxjQUFjLHlCQUUzQzRELEdBRHlCMUIsU0FBU2xDLGNBQWMsc0JBQzlCa0MsU0FBU2xDLGNBQWMsdUJBQ3pDNkQsRUFBb0JELEVBQWdCNUQsY0FDeEMsMkJBR0k4RCxHQURlNUIsU0FBU2xDLGNBQWM4QixHQUNaOEIsRUFBZ0I1RCxjQUM5QyxtQ0FPSStELEdBTGlCN0IsU0FBU2xDLGNIbUJkLG1CR2xCV2tDLFNBQVNsQyxjSG1CZCx5QkdoQkNrQyxTQUFTbEMsY0FBYzhCLEdBQzdCSSxTQUFTbEMsY0FBYzhCLElBQ3JCSSxTQUFTbEMsY0FBYzhCLEdBQ2pCSSxTQUFTbEMsY0FBYyx3QkFDL0J1QixpQkFBaUIsU0FBUyxXQUMzQ3lDLEVBQWlCekIsWUFDbkIsSUFFQW9CLEVBQWtCcEMsaUJBQWlCLFNBQVMsS0FDMUMsTUFBTSxLQUFFSyxFQUFJLFlBQUVxQyxHQUFnQkMsRUFBU0MsY0FFdkNOLEVBQWtCTCxNQUFRNUIsRUFDMUJrQyxFQUF3Qk4sTUFBUVMsRUFDaENHLEVBQWM1QixXQUFXLElBRzNCLE1BQU0wQixFQUFXLElDOUNGLE1BQ2JwRixZQUFZdUYsRUFBa0JDLEdBQzVCckYsS0FBS3NGLGlCQUFtQnJDLFNBQVNsQyxjQUFjcUUsR0FDL0NwRixLQUFLdUYsd0JBQTBCdEMsU0FBU2xDLGNBQ3RDc0UsRUFFSixDQUVBSCxjQUNFLE1BQU8sQ0FDTHZDLEtBQU0zQyxLQUFLc0YsaUJBQWlCbkUsWUFDNUI2RCxZQUFhaEYsS0FBS3VGLHdCQUF3QnBFLFlBRTlDLENBRUFxRSxZQUFZLEdBQXdCLElBQXhCLE1BQUVDLEVBQUssWUFBRVQsR0FBYSxFQUNoQ2hGLEtBQUtzRixpQkFBaUJuRSxZQUFjc0UsRUFDcEN6RixLQUFLdUYsd0JBQXdCcEUsWUFBYzZELENBQzdDLEdENEI0QixrQkFBbUIseUJBRTNDRCxFQUFtQixJRTlDVixjQUE2QmpDLEVBQzFDakQsWUFBWWtELEdBQ1ZpQixNQUFNakIsR0FFTi9DLEtBQUswRixjQUFnQjFGLEtBQUtnRCxjQUFjakMsY0FBYyxpQkFDdERmLEtBQUsyRixjQUFnQjNGLEtBQUtnRCxjQUFjakMsY0FDdEMsc0JBRUosQ0FFQTZFLEtBQUssR0FBaUIsSUFBakIsS0FBRWhELEVBQUksTUFBRTZDLEdBQU8sRUFDbEJ6RixLQUFLMEYsY0FBY0csSUFBTWpELEVBQ3pCNUMsS0FBSzBGLGNBQWNJLElBQU8sWUFBV0wsSUFDckN6RixLQUFLMkYsY0FBY3hFLFlBQWNzRSxFQUNqQ3pCLE1BQU1ULFdBQ1IsR0YrQjBDVixHQUV0Q2tELEVBQWMsSUdsREwsTUFDYmxHLFlBQVksRUFBcUJtRyxHQUFtQixJQUF4QyxNQUFFQyxFQUFLLFNBQUVDLEdBQVUsRUFDN0JsRyxLQUFLbUcsVUFBWUQsRUFDakJsRyxLQUFLb0csV0FBYW5ELFNBQVNsQyxjQUFjaUYsRUFDM0MsQ0FFQUssWUFBWUosR0FDVkEsRUFBTTVELFNBQVNpRSxJQUNidEcsS0FBS21HLFVBQVVHLEVBQUssR0FFeEIsQ0FFQUMsUUFBUUMsR0FDTnhHLEtBQUtvRyxXQUFXSyxRQUFRRCxFQUMxQixHSHFDQSxDQUNFUCxNQUFPdkQsRUFDUHdELFNBQVVRLEdBRVo3RCxHQUdJOEQsRUFBWTFELFNBQVNsQyxjQUFjLHFCQUNuQzZGLEVBQW9CLElBQUlDLEVBQzVCL0csRUFDQTZFLEdBRUZpQyxFQUFrQnBFLG1CQUVsQixNQUFNc0UsRUFBbUIsSUFBSUQsRUFBYy9HLEVBQW9CNkcsR0FDL0RHLEVBQWlCdEUsbUJBRWpCLE1BQU0yQyxFQUFnQixJQUFJckIsRUFBYyxDQUN0Q2YsY0FBZUYsRUFDZmtCLGlCQUFtQmdELElBQ2pCOUIsRUFBU08sWUFBWXVCLEdBRXJCNUIsRUFBYzdCLGFBQ2RzRCxFQUFrQmxGLGVBQWUsSUFHckN5RCxFQUFjM0IscUJBRWQsTUFBTXdELEVBQWUsSUFBSWxELEVBQWMsQ0FDckNmLGNBQWVGLEVBQ2ZrQixpQkFBbUJ1QyxJQUNqQlAsRUFBWVEsUUFBUVUsRUFBV1gsR0FBTVksV0FDckNGLEVBQWExRCxhQUNid0QsRUFBaUJwRixlQUFlLElBVXBDLFNBQVNnRixFQUFXUyxFQUFNQyxHQUN4QkEsRUFBVVgsUUFBUVUsRUFBS0QsVUFDekIsQ0FQQXhFLEVBQWEyRSxVQUFVaEYsU0FBU2lGLElBRTlCWixFQURhTyxFQUFXSyxHQUNQeEMsRUFBVyxJQU85QixNQUFNeUMsRUFBaUJ0RSxTQUFTbEMsY0FBYyxxQkFXOUMsU0FBU2tHLEVBQVdLLEdBT2xCLE9BTmEsSUk5R2YsTUFDRXpILFlBQVlrSCxFQUFNUyxFQUFjQyxHQUM5QnpILEtBQUswSCxNQUFRWCxFQUFLcEUsS0FDbEIzQyxLQUFLMkgsTUFBUVosRUFBS25FLEtBRWxCNUMsS0FBSzRILGNBQWdCSixFQUNyQnhILEtBQUs2SCxrQkFBb0JKLENBQzNCLENBRUF0RixxQkFDRW5DLEtBQUs4SCxTQUNGL0csY0FBYyxpQkFDZHVCLGlCQUFpQixTQUFTLElBQU10QyxLQUFLK0gsc0JBRXhDL0gsS0FBSzhILFNBQ0YvRyxjQUFjLGdCQUNkdUIsaUJBQWlCLFNBQVMsSUFBTXRDLEtBQUtnSSxzQkFFeENoSSxLQUFLOEgsU0FDRi9HLGNBQWMsZ0JBQ2R1QixpQkFBaUIsU0FBUyxJQUN6QnRDLEtBQUs2SCxrQkFBa0I3SCxLQUFLMkgsTUFBTzNILEtBQUswSCxRQUU5QyxDQUVBSyxvQkFDRS9ILEtBQUs4SCxTQUNGL0csY0FBYyxpQkFDZEUsVUFBVWdILE9BQU8sc0JBQ3RCLENBRUFELG9CQUNFaEksS0FBSzhILFNBQVN4RyxTQUNkdEIsS0FBSzhILFNBQVcsSUFDbEIsQ0FFQUksZUFDRSxPQUFPakYsU0FDSmxDLGNBQWNmLEtBQUs0SCxlQUNuQk8sUUFBUXBILGNBQWMsU0FDdEJxSCxXQUFVLEVBQ2YsQ0FFQWxCLFVBQ0VsSCxLQUFLOEgsU0FBVzlILEtBQUtrSSxlQUNyQixNQUFNRyxFQUFlckksS0FBSzhILFNBQVMvRyxjQUFjLGdCQU9qRCxPQU5Bc0gsRUFBYXhDLElBQU03RixLQUFLMkgsTUFDeEJVLEVBQWF2QyxJQUFPLFlBQVc5RixLQUFLMEgsUUFDbkIxSCxLQUFLOEgsU0FBUy9HLGNBQWMsZUFDcENJLFlBQWNuQixLQUFLMEgsTUFFNUIxSCxLQUFLbUMscUJBQ0VuQyxLQUFLOEgsUUFDZCxHSnlEc0JSLEVBQVUsa0JBQWtCLENBQUMxRSxFQUFNRCxLQUN2RG9DLEVBQWlCYSxLQUFLLENBQ3BCaEQsT0FDQTZDLE1BQU85QyxHQUNQLEdBR04sQ0FsQnNCTSxTQUFTbEMsY0FBYyx3QkFFL0J1QixpQkFBaUIsU0FBUyxXQUN0QzBFLEVBQWF6RCxXQUNmLElBRUFnRSxFQUFlakYsaUJBQWlCLFNBQVMsV0FDdkMwRSxFQUFhMUQsWUFDZixHIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vcHJhY3RpY3VtLy4vc3JjL2NvbXBvbmVudHMvRm9ybVZhbGlkYXRvci5qcyIsIndlYnBhY2s6Ly9wcmFjdGljdW0vLi9zcmMvdXRpbHMvY29uc3RhbnRzLmpzIiwid2VicGFjazovL3ByYWN0aWN1bS8uL3NyYy9jb21wb25lbnRzL1BvcHVwLmpzIiwid2VicGFjazovL3ByYWN0aWN1bS8uL3NyYy9jb21wb25lbnRzL1BvcHVwV2l0aEZvcm0uanMiLCJ3ZWJwYWNrOi8vcHJhY3RpY3VtLy4vc3JjL3BhZ2VzL2luZGV4LmpzIiwid2VicGFjazovL3ByYWN0aWN1bS8uL3NyYy9jb21wb25lbnRzL1VzZXJJbmZvLmpzIiwid2VicGFjazovL3ByYWN0aWN1bS8uL3NyYy9jb21wb25lbnRzL1BvcHVwV2l0aEltYWdlLmpzIiwid2VicGFjazovL3ByYWN0aWN1bS8uL3NyYy9jb21wb25lbnRzL1NlY3Rpb24uanMiLCJ3ZWJwYWNrOi8vcHJhY3RpY3VtLy4vc3JjL2NvbXBvbmVudHMvQ2FyZC5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyJjbGFzcyBGb3JtVmFsaWRhdG9yIHtcbiAgY29uc3RydWN0b3IodmFsaWRhdGlvblNldHRpbmdzLCBmb3JtRWxlbWVudCkge1xuICAgIHRoaXMuX2lucHV0U2VsZWN0b3IgPSB2YWxpZGF0aW9uU2V0dGluZ3MuaW5wdXRTZWxlY3RvcjtcbiAgICB0aGlzLl9zdWJtaXRCdXR0b25TZWxlY3RvciA9IHZhbGlkYXRpb25TZXR0aW5ncy5zdWJtaXRCdXR0b25TZWxlY3RvcjtcbiAgICB0aGlzLl9pbmFjdGl2ZUJ1dHRvbkNsYXNzID0gdmFsaWRhdGlvblNldHRpbmdzLmluYWN0aXZlQnV0dG9uQ2xhc3M7XG4gICAgdGhpcy5faW5wdXRFcnJvckNsYXNzID0gdmFsaWRhdGlvblNldHRpbmdzLmlucHV0RXJyb3JDbGFzcztcbiAgICB0aGlzLl9lcnJvckNsYXNzID0gdmFsaWRhdGlvblNldHRpbmdzLmVycm9yQ2xhc3M7XG4gICAgdGhpcy5fZm9ybSA9IGZvcm1FbGVtZW50O1xuICB9XG5cbiAgX3Nob3dJbnB1dEVycm9yKGlucHV0RWwpIHtcbiAgICBjb25zdCBlcnJvck1lc3NhZ2VzRWwgPSB0aGlzLl9mb3JtLnF1ZXJ5U2VsZWN0b3IoYCMke2lucHV0RWwuaWR9LWVycm9yYCk7XG4gICAgaW5wdXRFbC5jbGFzc0xpc3QuYWRkKHRoaXMuX2lucHV0RXJyb3JDbGFzcyk7XG4gICAgZXJyb3JNZXNzYWdlc0VsLnRleHRDb250ZW50ID0gaW5wdXRFbC52YWxpZGF0aW9uTWVzc2FnZTsgLy9mb3JtZXJseSBvbmx5IGlucHV0RWwudmFsaWRhdGlvbk1lc3NhZ2VcbiAgICBlcnJvck1lc3NhZ2VzRWwuY2xhc3NMaXN0LmFkZCh0aGlzLl9lcnJvckNsYXNzKTtcbiAgfVxuICBfaGlkZUlucHV0RXJyb3IoaW5wdXRFbCkge1xuICAgIGNvbnN0IGVycm9yTWVzc2FnZXNFbCA9IHRoaXMuX2Zvcm0ucXVlcnlTZWxlY3RvcihgIyR7aW5wdXRFbC5pZH0tZXJyb3JgKTtcbiAgICBpbnB1dEVsLmNsYXNzTGlzdC5yZW1vdmUodGhpcy5faW5wdXRFcnJvckNsYXNzKTtcbiAgICBlcnJvck1lc3NhZ2VzRWwudGV4dENvbnRlbnQgPSBcIlwiOyAvL2Zvcm1lcmx5IG9ubHkgXCJcIlxuICAgIGVycm9yTWVzc2FnZXNFbC5jbGFzc0xpc3QucmVtb3ZlKHRoaXMuX2Vycm9yQ2xhc3MpO1xuICB9XG5cbiAgLy8gV2hhdCBjYW4gSSBkbyB0byB0aGVzZSBwYXJhbWV0ZXJzPyAyNjo0NVxuICBfdG9nZ2xlQnV0dG9uU3RhdGUoKSB7XG4gICAgaWYgKHRoaXMuX2hhc0ludmFsaWRJbnB1dCh0aGlzLl9pbnB1dEVscykpIHtcbiAgICAgIHJldHVybiB0aGlzLmRpc2FibGVCdXR0b24oKTtcbiAgICB9XG4gICAgcmV0dXJuIHRoaXMuZW5hYmxlQnV0dG9uKCk7XG4gIH1cbiAgLy8gZm9yIFRvZ2dsZUJ1dHRvblN0YXRlJ3MgQnV0dG9uc1xuICAvLyBUaGlzIGFsc28gbWF5IGJlIGRpZmZlcmVudFxuICBfaGFzSW52YWxpZElucHV0KGlucHV0TGlzdCkge1xuICAgIHJldHVybiAhaW5wdXRMaXN0LmV2ZXJ5KChpbnB1dEVsKSA9PiBpbnB1dEVsLnZhbGlkaXR5LnZhbGlkKTtcbiAgfVxuICBkaXNhYmxlQnV0dG9uKCkge1xuICAgIHRoaXMuX3N1Ym1pdEJ1dHRvbi5jbGFzc0xpc3QuYWRkKHRoaXMuX2luYWN0aXZlQnV0dG9uQ2xhc3MpO1xuICAgIHRoaXMuX3N1Ym1pdEJ1dHRvbi5kaXNhYmxlZCA9IHRydWU7XG4gIH1cblxuICBlbmFibGVCdXR0b24oKSB7XG4gICAgdGhpcy5fc3VibWl0QnV0dG9uLmNsYXNzTGlzdC5yZW1vdmUodGhpcy5faW5hY3RpdmVCdXR0b25DbGFzcyk7XG4gICAgdGhpcy5fc3VibWl0QnV0dG9uLmRpc2FibGVkID0gZmFsc2U7XG4gIH1cblxuICBfY2hlY2tJbnB1dFZhbGlkaXR5KGlucHV0RWwpIHtcbiAgICBpZiAoIWlucHV0RWwudmFsaWRpdHkudmFsaWQpIHtcbiAgICAgIHJldHVybiB0aGlzLl9zaG93SW5wdXRFcnJvcihpbnB1dEVsKTtcbiAgICB9XG4gICAgdGhpcy5faGlkZUlucHV0RXJyb3IoaW5wdXRFbCk7XG4gIH1cblxuICBfc2V0RXZlbnRMaXN0ZW5lcnMoKSB7XG4gICAgdGhpcy5faW5wdXRFbHMgPSBbLi4udGhpcy5fZm9ybS5xdWVyeVNlbGVjdG9yQWxsKHRoaXMuX2lucHV0U2VsZWN0b3IpXTtcbiAgICB0aGlzLl9zdWJtaXRCdXR0b24gPSB0aGlzLl9mb3JtLnF1ZXJ5U2VsZWN0b3IodGhpcy5fc3VibWl0QnV0dG9uU2VsZWN0b3IpO1xuICAgIHRoaXMuX2lucHV0RWxzLmZvckVhY2goKGlucHV0RWwpID0+IHtcbiAgICAgIGlucHV0RWwuYWRkRXZlbnRMaXN0ZW5lcihcImlucHV0XCIsIChlKSA9PiB7XG4gICAgICAgIHRoaXMuX2NoZWNrSW5wdXRWYWxpZGl0eShpbnB1dEVsKTtcbiAgICAgICAgdGhpcy5fdG9nZ2xlQnV0dG9uU3RhdGUodGhpcy5faW5wdXRFbHMsIHRoaXMuX3N1Ym1pdEJ1dHRvbik7XG4gICAgICB9KTtcbiAgICB9KTtcbiAgfVxuXG4gIGVuYWJsZVZhbGlkYXRpb24oKSB7XG4gICAgdGhpcy5fZm9ybS5hZGRFdmVudExpc3RlbmVyKFwic3VibWl0XCIsIChlKSA9PiB7XG4gICAgICBlLnByZXZlbnREZWZhdWx0KCk7XG4gICAgfSk7XG4gICAgdGhpcy5fc2V0RXZlbnRMaXN0ZW5lcnMoKTsgLy9mb3JtZXJseSBmb3JtRWwgYW5kIG9wdGlvbnMgYXMgYXJndW1lbnRzXG4gIH1cbn1cblxuZXhwb3J0IGRlZmF1bHQgRm9ybVZhbGlkYXRvcjtcbiIsImV4cG9ydCBjb25zdCBpbml0aWFsQ2FyZHMgPSBbXG4gIHtcbiAgICBuYW1lOiBcIllvc2VtaXRlIFZhbGxleVwiLFxuICAgIGxpbms6IFwiaHR0cHM6Ly9jb2RlLnMzLnlhbmRleC5uZXQvd2ViLWNvZGUveW9zZW1pdGUuanBnXCIsXG4gIH0sXG4gIHtcbiAgICBuYW1lOiBcIkxha2UgTG91aXNlXCIsXG4gICAgbGluazogXCJodHRwczovL2NvZGUuczMueWFuZGV4Lm5ldC93ZWItY29kZS9sYWtlLWxvdWlzZS5qcGdcIixcbiAgfSxcbiAge1xuICAgIG5hbWU6IFwiQmFsZCBNb3VudGFpbnNcIixcbiAgICBsaW5rOiBcImh0dHBzOi8vY29kZS5zMy55YW5kZXgubmV0L3dlYi1jb2RlL2JhbGQtbW91bnRhaW5zLmpwZ1wiLFxuICB9LFxuICB7XG4gICAgbmFtZTogXCJMYXRlbWFyXCIsXG4gICAgbGluazogXCJodHRwczovL2NvZGUuczMueWFuZGV4Lm5ldC93ZWItY29kZS9sYXRlbWFyLmpwZ1wiLFxuICB9LFxuICB7XG4gICAgbmFtZTogXCJWYW5vaXNlIE5hdGlvbmFsIFBhcmtcIixcbiAgICBsaW5rOiBcImh0dHBzOi8vY29kZS5zMy55YW5kZXgubmV0L3dlYi1jb2RlL3Zhbm9pc2UuanBnXCIsXG4gIH0sXG4gIHtcbiAgICBuYW1lOiBcIkxhZ28gZGkgQnJhaWVzXCIsXG4gICAgbGluazogXCJodHRwczovL2NvZGUuczMueWFuZGV4Lm5ldC93ZWItY29kZS9sYWdvLmpwZyBcIixcbiAgfSxcbl07XG5cbmV4cG9ydCBjb25zdCB2YWxpZGF0aW9uU2V0dGluZ3MgPSB7XG4gIGlucHV0U2VsZWN0b3I6IFwiLnBvcHVwX19pbnB1dFwiLFxuICBzdWJtaXRCdXR0b25TZWxlY3RvcjogXCIucG9wdXBfX2J1dHRvblwiLFxuICBpbmFjdGl2ZUJ1dHRvbkNsYXNzOiBcInBvcHVwX19idXR0b25fZGlzYWJsZWRcIixcbiAgaW5wdXRFcnJvckNsYXNzOiBcInBvcHVwX19pbnB1dF90eXBlX2Vycm9yXCIsXG4gIGVycm9yQ2xhc3M6IFwicG9wdXBfX2Vycm9yX3Zpc2libGVcIixcbn07XG5cbmV4cG9ydCBjb25zdCBzZWxlY3RvcnMgPSB7XG4gIGNhcmRMaXN0RWw6IFwiLmNhcmQtbGlzdFwiLFxuICBjYXJkVGVtcGxhdGU6IFwiI2NhcmQtdGVtcGxhdGVcIixcbiAgaW1hZ2VQcmV2aWV3OiBcIiNpbWFnZV9wcmV2aWV3XCIsXG5cbiAgdXNlck5hbWU6IFwiLnBvcHVwX19pbnB1dF90eXBlX25hbWVcIixcbiAgdXNlckRlc2NyaXB0aW9uOiBcIi5wb3B1cF9faW5wdXRfdHlwZV9kZXNjcmlwdGlvblwiLFxuXG4gIGVkaXRQb3B1cDogXCIjZWRpdC1wb3B1cFwiLFxuICBhZGRQb3B1cDogXCIjYWRkLXBvcHVwXCIsXG4gIHByb2ZpbGVUaXRsZUVsOiBcIi5wcm9maWxlX190aXRsZVwiLFxuICBwcm9maWxlRGVzY3JpcHRpb25FbDogXCIucHJvZmlsZV9fZGVzY3JpcHRpb25cIixcbn07XG4iLCJleHBvcnQgZGVmYXVsdCBjbGFzcyBQb3B1cCB7XG4gIGNvbnN0cnVjdG9yKHBvcHVwU2VsZWN0b3IpIHtcbiAgICB0aGlzLl9wb3B1cEVsZW1lbnQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKHBvcHVwU2VsZWN0b3IpO1xuICAgIHRoaXMuX2hhbmRsZUVzY1ByZXNzID0gdGhpcy5faGFuZGxlRXNjUHJlc3MuYmluZCh0aGlzKTtcbiAgICB0aGlzLl9oYW5kbGVPdmVybGF5ID0gdGhpcy5faGFuZGxlT3ZlcmxheS5iaW5kKHRoaXMpO1xuICAgIHRoaXMuX2Nsb3NlQnV0dG9uID0gdGhpcy5fcG9wdXBFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIucG9wdXBfX2Nsb3NlXCIpO1xuICAgIHRoaXMuY2xvc2VQb3B1cCA9IHRoaXMuY2xvc2VQb3B1cC5iaW5kKHRoaXMpO1xuICB9XG5cbiAgb3BlblBvcHVwKCkge1xuICAgIHRoaXMuX3BvcHVwRWxlbWVudC5jbGFzc0xpc3QuYWRkKFwicG9wdXBfaXMtb3BlbmVkXCIpO1xuICAgIHRoaXMuc2V0RXZlbnRzTGlzdGVuZXJzKCk7XG4gIH1cblxuICBjbG9zZVBvcHVwKCkge1xuICAgIHRoaXMuX3BvcHVwRWxlbWVudC5jbGFzc0xpc3QucmVtb3ZlKFwicG9wdXBfaXMtb3BlbmVkXCIpO1xuICAgIHRoaXMucmVtb3ZlRXZlbnRzTGlzdGVuZXJzKCk7XG4gIH1cblxuICBzZXRFdmVudHNMaXN0ZW5lcnMoKSB7XG4gICAgdGhpcy5fY2xvc2VCdXR0b24uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIHRoaXMuY2xvc2VQb3B1cCk7XG4gICAgZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihcImtleWRvd25cIiwgdGhpcy5faGFuZGxlRXNjUHJlc3MpO1xuICAgIHRoaXMuX3BvcHVwRWxlbWVudC5hZGRFdmVudExpc3RlbmVyKFwibW91c2Vkb3duXCIsIHRoaXMuX2hhbmRsZU92ZXJsYXkpO1xuICB9XG5cbiAgcmVtb3ZlRXZlbnRzTGlzdGVuZXJzKCkge1xuICAgIHRoaXMuX2Nsb3NlQnV0dG9uLnJlbW92ZUV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCB0aGlzLmNsb3NlUG9wdXApO1xuICAgIGRvY3VtZW50LnJlbW92ZUV2ZW50TGlzdGVuZXIoXCJrZXlkb3duXCIsIHRoaXMuX2hhbmRsZUVzY1ByZXNzKTtcbiAgICB0aGlzLl9wb3B1cEVsZW1lbnQucmVtb3ZlRXZlbnRMaXN0ZW5lcihcIm1vdXNlZG93blwiLCB0aGlzLl9oYW5kbGVPdmVybGF5KTtcbiAgfVxuXG4gIF9oYW5kbGVFc2NQcmVzcyhlKSB7XG4gICAgaWYgKGUua2V5ID09PSBcIkVzY2FwZVwiKSB7XG4gICAgICB0aGlzLmNsb3NlUG9wdXAoKTtcbiAgICB9XG4gIH1cblxuICBfaGFuZGxlT3ZlcmxheShlKSB7XG4gICAgaWYgKGUudGFyZ2V0LmNsYXNzTGlzdC5jb250YWlucyhcInBvcHVwXCIpKSB7XG4gICAgICB0aGlzLmNsb3NlUG9wdXAoKTtcbiAgICB9XG4gIH1cbn1cbiIsImltcG9ydCBQb3B1cCBmcm9tIFwiLi9Qb3B1cFwiO1xuXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBQb3B1cFdpdGhGb3JtIGV4dGVuZHMgUG9wdXAge1xuICBjb25zdHJ1Y3Rvcih7IHBvcHVwU2VsZWN0b3IsIGhhbmRsZUZvcm1TdWJtaXQgfSkge1xuICAgIHN1cGVyKHBvcHVwU2VsZWN0b3IpO1xuXG4gICAgdGhpcy5fcG9wdXBGb3JtID0gdGhpcy5fcG9wdXBFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIucG9wdXBfX2Zvcm1cIik7XG4gICAgdGhpcy5faW5wdXRMaXN0ID0gdGhpcy5fcG9wdXBGb3JtLnF1ZXJ5U2VsZWN0b3JBbGwoXCIucG9wdXBfX2lucHV0XCIpO1xuICAgIHRoaXMuX2hhbmRsZUZvcm1TdWJtaXQgPSBoYW5kbGVGb3JtU3VibWl0O1xuICB9XG5cbiAgX2dldElucHV0VmFsdWVzKCkge1xuICAgIGNvbnN0IGlucHV0VmFsdWVzID0ge307XG4gICAgdGhpcy5faW5wdXRMaXN0LmZvckVhY2goKGlucHV0KSA9PiAoaW5wdXRWYWx1ZXNbaW5wdXQubmFtZV0gPSBpbnB1dC52YWx1ZSkpO1xuICAgIHJldHVybiBpbnB1dFZhbHVlcztcbiAgfVxuXG4gIGhhbmRsZVN1Ym1pdCA9IChlKSA9PiB7XG4gICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xuICAgIHRoaXMuX2hhbmRsZUZvcm1TdWJtaXQodGhpcy5fZ2V0SW5wdXRWYWx1ZXMoKSk7XG4gIH07XG5cbiAgc2V0RXZlbnRzTGlzdGVuZXJzKCkge1xuICAgIHN1cGVyLnNldEV2ZW50c0xpc3RlbmVycygpO1xuICAgIHRoaXMuX3BvcHVwRm9ybS5hZGRFdmVudExpc3RlbmVyKFwic3VibWl0XCIsIHRoaXMuaGFuZGxlU3VibWl0KTtcbiAgfVxuXG4gIHJlbW92ZUV2ZW50c0xpc3RlbmVycygpIHtcbiAgICBzdXBlci5yZW1vdmVFdmVudHNMaXN0ZW5lcnMoKTtcbiAgICB0aGlzLl9wb3B1cEZvcm0ucmVtb3ZlRXZlbnRMaXN0ZW5lcihcInN1Ym1pdFwiLCB0aGlzLmhhbmRsZVN1Ym1pdCk7XG4gIH1cblxuICBjbG9zZVBvcHVwKCkge1xuICAgIHRoaXMuX3BvcHVwRm9ybS5yZXNldCgpO1xuICAgIHN1cGVyLmNsb3NlUG9wdXAoKTtcbiAgfVxufVxuIiwiaW1wb3J0IFwiLi4vcGFnZXMvaW5kZXguY3NzXCI7XG5pbXBvcnQgRm9ybVZhbGlkYXRvciBmcm9tIFwiLi4vY29tcG9uZW50cy9Gb3JtVmFsaWRhdG9yLmpzXCI7XG5pbXBvcnQgQ2FyZCBmcm9tIFwiLi4vY29tcG9uZW50cy9DYXJkLmpzXCI7XG5cbmltcG9ydCB7XG4gIHZhbGlkYXRpb25TZXR0aW5ncyxcbiAgc2VsZWN0b3JzLFxuICBpbml0aWFsQ2FyZHMsXG59IGZyb20gXCIuLi91dGlscy9jb25zdGFudHMuanNcIjtcblxuaW1wb3J0IFVzZXJJbmZvIGZyb20gXCIuLi9jb21wb25lbnRzL1VzZXJJbmZvLmpzXCI7XG5pbXBvcnQgU2VjdGlvbiBmcm9tIFwiLi4vY29tcG9uZW50cy9TZWN0aW9uLmpzXCI7XG5pbXBvcnQgUG9wdXBXaXRoSW1hZ2UgZnJvbSBcIi4uL2NvbXBvbmVudHMvUG9wdXBXaXRoSW1hZ2UuanNcIjtcbmltcG9ydCBQb3B1cFdpdGhGb3JtIGZyb20gXCIuLi9jb21wb25lbnRzL1BvcHVwV2l0aEZvcm0uanNcIjtcbmltcG9ydCBQb3B1cCBmcm9tIFwiLi4vY29tcG9uZW50cy9Qb3B1cFwiO1xuXG5jb25zdCBwcm9maWxlRWRpdEJ1dHRvbiA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIucHJvZmlsZV9fZWRpdC1idXR0b25cIik7XG5jb25zdCBwcm9maWxlRWRpdENsb3NlQnV0dG9uID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIiNlZGl0X2Nsb3NlLWJ1dHRvblwiKTtcbmNvbnN0IHByb2ZpbGVFZGl0Rm9ybSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjZWRpdC1wcm9maWxlLWZvcm1cIik7XG5jb25zdCBwcm9maWxlVGl0bGVJbnB1dCA9IHByb2ZpbGVFZGl0Rm9ybS5xdWVyeVNlbGVjdG9yKFxuICBcIi5wb3B1cF9faW5wdXRfdHlwZV9uYW1lXCJcbik7XG5jb25zdCBpbWFnZVByZXZpZXcgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKHNlbGVjdG9ycy5pbWFnZVByZXZpZXcpO1xuY29uc3QgcHJvZmlsZURlc2NyaXB0aW9uSW5wdXQgPSBwcm9maWxlRWRpdEZvcm0ucXVlcnlTZWxlY3RvcihcbiAgXCIucG9wdXBfX2lucHV0X3R5cGVfZGVzY3JpcHRpb25cIlxuKTtcbmNvbnN0IHByb2ZpbGVUaXRsZUVsID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihzZWxlY3RvcnMucHJvZmlsZVRpdGxlRWwpO1xuY29uc3QgcHJvZmlsZURlc2NyaXB0aW9uRWwgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFxuICBzZWxlY3RvcnMucHJvZmlsZURlc2NyaXB0aW9uRWxcbik7XG5jb25zdCBwcm9maWxlRWRpdFBvcHVwID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihzZWxlY3RvcnMuZWRpdFBvcHVwKTtcbmNvbnN0IGNhcmRMaXN0RWwgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKHNlbGVjdG9ycy5jYXJkTGlzdEVsKTtcbmNvbnN0IGFkZENhcmRQb3B1cCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3Ioc2VsZWN0b3JzLmFkZFBvcHVwKTtcbmNvbnN0IHByZXZpZXdDbG9zZUJ1dHRvbiA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjaW1hZ2VfcHJldmlldy1jbG9zZVwiKTtcbnByZXZpZXdDbG9zZUJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgZnVuY3Rpb24gKCkge1xuICBjYXJkUHJldmlld1BvcHVwLmNsb3NlUG9wdXAoKTtcbn0pO1xuXG5wcm9maWxlRWRpdEJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4ge1xuICBjb25zdCB7IG5hbWUsIGRlc2NyaXB0aW9uIH0gPSB1c2VySW5mby5nZXRVc2VySW5mbygpO1xuXG4gIHByb2ZpbGVUaXRsZUlucHV0LnZhbHVlID0gbmFtZTtcbiAgcHJvZmlsZURlc2NyaXB0aW9uSW5wdXQudmFsdWUgPSBkZXNjcmlwdGlvbjtcbiAgZWRpdEZvcm1Qb3B1cC5vcGVuUG9wdXAoKTtcbn0pO1xuXG5jb25zdCB1c2VySW5mbyA9IG5ldyBVc2VySW5mbyhcIi5wcm9maWxlX190aXRsZVwiLCBcIi5wcm9maWxlX19kZXNjcmlwdGlvblwiKTtcblxuY29uc3QgY2FyZFByZXZpZXdQb3B1cCA9IG5ldyBQb3B1cFdpdGhJbWFnZShzZWxlY3RvcnMuaW1hZ2VQcmV2aWV3KTtcblxuY29uc3QgY2FyZFNlY3Rpb24gPSBuZXcgU2VjdGlvbihcbiAge1xuICAgIGl0ZW1zOiBpbml0aWFsQ2FyZHMsXG4gICAgcmVuZGVyZXI6IHJlbmRlckNhcmQsXG4gIH0sXG4gIHNlbGVjdG9ycy5jYXJkTGlzdEVsXG4pO1xuLy9mb3JtVmFsaWRhdGlvblxuY29uc3QgYWRkRm9ybUVsID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIiNhZGQtcHJvZmlsZS1mb3JtXCIpO1xuY29uc3QgZWRpdEZvcm1WYWxpZGF0b3IgPSBuZXcgRm9ybVZhbGlkYXRvcihcbiAgdmFsaWRhdGlvblNldHRpbmdzLFxuICBwcm9maWxlRWRpdEZvcm1cbik7XG5lZGl0Rm9ybVZhbGlkYXRvci5lbmFibGVWYWxpZGF0aW9uKCk7XG5cbmNvbnN0IGFkZEZvcm1WYWxpZGF0b3IgPSBuZXcgRm9ybVZhbGlkYXRvcih2YWxpZGF0aW9uU2V0dGluZ3MsIGFkZEZvcm1FbCk7XG5hZGRGb3JtVmFsaWRhdG9yLmVuYWJsZVZhbGlkYXRpb24oKTtcbi8vLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuY29uc3QgZWRpdEZvcm1Qb3B1cCA9IG5ldyBQb3B1cFdpdGhGb3JtKHtcbiAgcG9wdXBTZWxlY3Rvcjogc2VsZWN0b3JzLmVkaXRQb3B1cCxcbiAgaGFuZGxlRm9ybVN1Ym1pdDogKGRhdGEpID0+IHtcbiAgICB1c2VySW5mby5zZXRVc2VySW5mbyhkYXRhKTtcblxuICAgIGVkaXRGb3JtUG9wdXAuY2xvc2VQb3B1cCgpO1xuICAgIGVkaXRGb3JtVmFsaWRhdG9yLmRpc2FibGVCdXR0b24oKTtcbiAgfSxcbn0pO1xuZWRpdEZvcm1Qb3B1cC5zZXRFdmVudHNMaXN0ZW5lcnMoKTtcblxuY29uc3QgYWRkRm9ybVBvcHVwID0gbmV3IFBvcHVwV2l0aEZvcm0oe1xuICBwb3B1cFNlbGVjdG9yOiBzZWxlY3RvcnMuYWRkUG9wdXAsXG4gIGhhbmRsZUZvcm1TdWJtaXQ6IChpdGVtKSA9PiB7XG4gICAgY2FyZFNlY3Rpb24uYWRkSXRlbShjcmVhdGVDYXJkKGl0ZW0pLmdldFZpZXcoKSk7XG4gICAgYWRkRm9ybVBvcHVwLmNsb3NlUG9wdXAoKTtcbiAgICBhZGRGb3JtVmFsaWRhdG9yLmRpc2FibGVCdXR0b24oKTtcbiAgfSxcbn0pO1xuLy8tLS0tLS0tLS0tLS0tLS0tXG5cbmluaXRpYWxDYXJkcy5yZXZlcnNlKCkuZm9yRWFjaCgoY2FyZERhdGEpID0+IHtcbiAgY29uc3QgY2FyZCA9IGNyZWF0ZUNhcmQoY2FyZERhdGEpO1xuICByZW5kZXJDYXJkKGNhcmQsIGNhcmRMaXN0RWwpO1xufSk7XG5cbmZ1bmN0aW9uIHJlbmRlckNhcmQoY2FyZCwgY29udGFpbmVyKSB7XG4gIGNvbnRhaW5lci5wcmVwZW5kKGNhcmQuZ2V0VmlldygpKTtcbn1cblxuY29uc3QgYWRkQ2xvc2VCdXR0b24gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiI2FkZF9jbG9zZS1idXR0b25cIik7XG5jb25zdCBhZGRDYXJkQnV0dG9uID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5wcm9maWxlX19hZGQtYnV0dG9uXCIpO1xuXG5hZGRDYXJkQnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCBmdW5jdGlvbiAoKSB7XG4gIGFkZEZvcm1Qb3B1cC5vcGVuUG9wdXAoKTtcbn0pO1xuXG5hZGRDbG9zZUJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgZnVuY3Rpb24gKCkge1xuICBhZGRGb3JtUG9wdXAuY2xvc2VQb3B1cCgpO1xufSk7XG5cbmZ1bmN0aW9uIGNyZWF0ZUNhcmQoY2FyZERhdGEpIHtcbiAgY29uc3QgY2FyZCA9IG5ldyBDYXJkKGNhcmREYXRhLCBcIiNjYXJkLXRlbXBsYXRlXCIsIChsaW5rLCBuYW1lKSA9PiB7XG4gICAgY2FyZFByZXZpZXdQb3B1cC5vcGVuKHtcbiAgICAgIGxpbmssXG4gICAgICB0aXRsZTogbmFtZSxcbiAgICB9KTtcbiAgfSk7XG4gIHJldHVybiBjYXJkO1xufVxuIiwiZXhwb3J0IGRlZmF1bHQgY2xhc3MgVXNlckluZm8ge1xuICBjb25zdHJ1Y3Rvcih1c2VyTmFtZVNlbGVjdG9yLCB1c2VyRGVzY3JpcHRpb25TZWxlY3Rvcikge1xuICAgIHRoaXMuX3VzZXJOYW1lRWxlbWVudCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IodXNlck5hbWVTZWxlY3Rvcik7XG4gICAgdGhpcy5fdXNlckRlc2NyaXB0aW9uRWxlbWVudCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXG4gICAgICB1c2VyRGVzY3JpcHRpb25TZWxlY3RvclxuICAgICk7XG4gIH1cblxuICBnZXRVc2VySW5mbygpIHtcbiAgICByZXR1cm4ge1xuICAgICAgbmFtZTogdGhpcy5fdXNlck5hbWVFbGVtZW50LnRleHRDb250ZW50LFxuICAgICAgZGVzY3JpcHRpb246IHRoaXMuX3VzZXJEZXNjcmlwdGlvbkVsZW1lbnQudGV4dENvbnRlbnQsXG4gICAgfTtcbiAgfVxuXG4gIHNldFVzZXJJbmZvKHsgdGl0bGUsIGRlc2NyaXB0aW9uIH0pIHtcbiAgICB0aGlzLl91c2VyTmFtZUVsZW1lbnQudGV4dENvbnRlbnQgPSB0aXRsZTtcbiAgICB0aGlzLl91c2VyRGVzY3JpcHRpb25FbGVtZW50LnRleHRDb250ZW50ID0gZGVzY3JpcHRpb247XG4gIH1cbn1cbiIsImltcG9ydCBQb3B1cCBmcm9tIFwiLi9Qb3B1cFwiO1xuXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBQb3B1cFdpdGhJbWFnZSBleHRlbmRzIFBvcHVwIHtcbiAgY29uc3RydWN0b3IocG9wdXBTZWxlY3Rvcikge1xuICAgIHN1cGVyKHBvcHVwU2VsZWN0b3IpO1xuXG4gICAgdGhpcy5faW1hZ2VFbGVtZW50ID0gdGhpcy5fcG9wdXBFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIucG9wdXBfX2ltYWdlXCIpO1xuICAgIHRoaXMuX2ltYWdlQ2FwdGlvbiA9IHRoaXMuX3BvcHVwRWxlbWVudC5xdWVyeVNlbGVjdG9yKFxuICAgICAgXCIucG9wdXBfX2ltYWdlLXRpdGxlXCJcbiAgICApO1xuICB9XG5cbiAgb3Blbih7IGxpbmssIHRpdGxlIH0pIHtcbiAgICB0aGlzLl9pbWFnZUVsZW1lbnQuc3JjID0gbGluaztcbiAgICB0aGlzLl9pbWFnZUVsZW1lbnQuYWx0ID0gYEltYWdlIG9mICR7dGl0bGV9YDtcbiAgICB0aGlzLl9pbWFnZUNhcHRpb24udGV4dENvbnRlbnQgPSB0aXRsZTtcbiAgICBzdXBlci5vcGVuUG9wdXAoKTtcbiAgfVxufVxuIiwiZXhwb3J0IGRlZmF1bHQgY2xhc3MgU2VjdGlvbiB7XG4gIGNvbnN0cnVjdG9yKHsgaXRlbXMsIHJlbmRlcmVyIH0sIGNvbnRhaW5lclNlbGVjdG9yKSB7XG4gICAgdGhpcy5fcmVuZGVyZXIgPSByZW5kZXJlcjtcbiAgICB0aGlzLl9jb250YWluZXIgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKGNvbnRhaW5lclNlbGVjdG9yKTtcbiAgfVxuXG4gIHJlbmRlckl0ZW1zKGl0ZW1zKSB7XG4gICAgaXRlbXMuZm9yRWFjaCgoaXRlbSkgPT4ge1xuICAgICAgdGhpcy5fcmVuZGVyZXIoaXRlbSk7XG4gICAgfSk7XG4gIH1cblxuICBhZGRJdGVtKGVsZW1lbnQpIHtcbiAgICB0aGlzLl9jb250YWluZXIucHJlcGVuZChlbGVtZW50KTtcbiAgfVxufVxuIiwiY2xhc3MgQ2FyZCB7XG4gIGNvbnN0cnVjdG9yKGRhdGEsIGNhcmRTZWxlY3RvciwgaGFuZGxlSW1hZ2VDbGljaykge1xuICAgIHRoaXMuX25hbWUgPSBkYXRhLm5hbWU7XG4gICAgdGhpcy5fbGluayA9IGRhdGEubGluaztcblxuICAgIHRoaXMuX2NhcmRTZWxlY3RvciA9IGNhcmRTZWxlY3RvcjtcbiAgICB0aGlzLl9oYW5kbGVJbWFnZUNsaWNrID0gaGFuZGxlSW1hZ2VDbGljaztcbiAgfVxuXG4gIF9zZXRFdmVudExpc3RlbmVycygpIHtcbiAgICB0aGlzLl9lbGVtZW50XG4gICAgICAucXVlcnlTZWxlY3RvcihcIi5jYXJkX19idXR0b25cIilcbiAgICAgIC5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4gdGhpcy5faGFuZGxlTGlrZUJ1dHRvbigpKTtcblxuICAgIHRoaXMuX2VsZW1lbnRcbiAgICAgIC5xdWVyeVNlbGVjdG9yKFwiLmNhcmRfX3RyYXNoXCIpXG4gICAgICAuYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHRoaXMuX2hhbmRsZURlbGV0ZUNhcmQoKSk7XG5cbiAgICB0aGlzLl9lbGVtZW50XG4gICAgICAucXVlcnlTZWxlY3RvcihcIi5jYXJkX19pbWFnZVwiKVxuICAgICAgLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PlxuICAgICAgICB0aGlzLl9oYW5kbGVJbWFnZUNsaWNrKHRoaXMuX2xpbmssIHRoaXMuX25hbWUpXG4gICAgICApO1xuICB9XG5cbiAgX2hhbmRsZUxpa2VCdXR0b24oKSB7XG4gICAgdGhpcy5fZWxlbWVudFxuICAgICAgLnF1ZXJ5U2VsZWN0b3IoXCIuY2FyZF9fYnV0dG9uXCIpXG4gICAgICAuY2xhc3NMaXN0LnRvZ2dsZShcImNhcmRfX2J1dHRvbl9hY3RpdmVcIik7XG4gIH1cblxuICBfaGFuZGxlRGVsZXRlQ2FyZCgpIHtcbiAgICB0aGlzLl9lbGVtZW50LnJlbW92ZSgpO1xuICAgIHRoaXMuX2VsZW1lbnQgPSBudWxsO1xuICB9XG5cbiAgX2dldFRlbXBsYXRlKCkge1xuICAgIHJldHVybiBkb2N1bWVudFxuICAgICAgLnF1ZXJ5U2VsZWN0b3IodGhpcy5fY2FyZFNlbGVjdG9yKVxuICAgICAgLmNvbnRlbnQucXVlcnlTZWxlY3RvcihcIi5jYXJkXCIpXG4gICAgICAuY2xvbmVOb2RlKHRydWUpO1xuICB9XG5cbiAgZ2V0VmlldygpIHtcbiAgICB0aGlzLl9lbGVtZW50ID0gdGhpcy5fZ2V0VGVtcGxhdGUoKTtcbiAgICBjb25zdCBpbWFnZUVsZW1lbnQgPSB0aGlzLl9lbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuY2FyZF9faW1hZ2VcIik7XG4gICAgaW1hZ2VFbGVtZW50LnNyYyA9IHRoaXMuX2xpbms7XG4gICAgaW1hZ2VFbGVtZW50LmFsdCA9IGBJbWFnZSBvZiAke3RoaXMuX25hbWV9YDtcbiAgICBjb25zdCBjYXJkVGV4dCA9IHRoaXMuX2VsZW1lbnQucXVlcnlTZWxlY3RvcihcIi5jYXJkX190ZXh0XCIpO1xuICAgIGNhcmRUZXh0LnRleHRDb250ZW50ID0gdGhpcy5fbmFtZTtcblxuICAgIHRoaXMuX3NldEV2ZW50TGlzdGVuZXJzKCk7XG4gICAgcmV0dXJuIHRoaXMuX2VsZW1lbnQ7XG4gIH1cbn1cblxuZXhwb3J0IGRlZmF1bHQgQ2FyZDtcbiJdLCJuYW1lcyI6WyJjb25zdHJ1Y3RvciIsInZhbGlkYXRpb25TZXR0aW5ncyIsImZvcm1FbGVtZW50IiwidGhpcyIsIl9pbnB1dFNlbGVjdG9yIiwiaW5wdXRTZWxlY3RvciIsIl9zdWJtaXRCdXR0b25TZWxlY3RvciIsInN1Ym1pdEJ1dHRvblNlbGVjdG9yIiwiX2luYWN0aXZlQnV0dG9uQ2xhc3MiLCJpbmFjdGl2ZUJ1dHRvbkNsYXNzIiwiX2lucHV0RXJyb3JDbGFzcyIsImlucHV0RXJyb3JDbGFzcyIsIl9lcnJvckNsYXNzIiwiZXJyb3JDbGFzcyIsIl9mb3JtIiwiX3Nob3dJbnB1dEVycm9yIiwiaW5wdXRFbCIsImVycm9yTWVzc2FnZXNFbCIsInF1ZXJ5U2VsZWN0b3IiLCJpZCIsImNsYXNzTGlzdCIsImFkZCIsInRleHRDb250ZW50IiwidmFsaWRhdGlvbk1lc3NhZ2UiLCJfaGlkZUlucHV0RXJyb3IiLCJyZW1vdmUiLCJfdG9nZ2xlQnV0dG9uU3RhdGUiLCJfaGFzSW52YWxpZElucHV0IiwiX2lucHV0RWxzIiwiZGlzYWJsZUJ1dHRvbiIsImVuYWJsZUJ1dHRvbiIsImlucHV0TGlzdCIsImV2ZXJ5IiwidmFsaWRpdHkiLCJ2YWxpZCIsIl9zdWJtaXRCdXR0b24iLCJkaXNhYmxlZCIsIl9jaGVja0lucHV0VmFsaWRpdHkiLCJfc2V0RXZlbnRMaXN0ZW5lcnMiLCJxdWVyeVNlbGVjdG9yQWxsIiwiZm9yRWFjaCIsImFkZEV2ZW50TGlzdGVuZXIiLCJlIiwiZW5hYmxlVmFsaWRhdGlvbiIsInByZXZlbnREZWZhdWx0IiwiaW5pdGlhbENhcmRzIiwibmFtZSIsImxpbmsiLCJzZWxlY3RvcnMiLCJQb3B1cCIsInBvcHVwU2VsZWN0b3IiLCJfcG9wdXBFbGVtZW50IiwiZG9jdW1lbnQiLCJfaGFuZGxlRXNjUHJlc3MiLCJiaW5kIiwiX2hhbmRsZU92ZXJsYXkiLCJfY2xvc2VCdXR0b24iLCJjbG9zZVBvcHVwIiwib3BlblBvcHVwIiwic2V0RXZlbnRzTGlzdGVuZXJzIiwicmVtb3ZlRXZlbnRzTGlzdGVuZXJzIiwicmVtb3ZlRXZlbnRMaXN0ZW5lciIsImtleSIsInRhcmdldCIsImNvbnRhaW5zIiwiUG9wdXBXaXRoRm9ybSIsImhhbmRsZUZvcm1TdWJtaXQiLCJzdXBlciIsIl9oYW5kbGVGb3JtU3VibWl0IiwiX2dldElucHV0VmFsdWVzIiwiX3BvcHVwRm9ybSIsIl9pbnB1dExpc3QiLCJpbnB1dFZhbHVlcyIsImlucHV0IiwidmFsdWUiLCJoYW5kbGVTdWJtaXQiLCJyZXNldCIsInByb2ZpbGVFZGl0QnV0dG9uIiwicHJvZmlsZUVkaXRGb3JtIiwicHJvZmlsZVRpdGxlSW5wdXQiLCJwcm9maWxlRGVzY3JpcHRpb25JbnB1dCIsImNhcmRMaXN0RWwiLCJjYXJkUHJldmlld1BvcHVwIiwiZGVzY3JpcHRpb24iLCJ1c2VySW5mbyIsImdldFVzZXJJbmZvIiwiZWRpdEZvcm1Qb3B1cCIsInVzZXJOYW1lU2VsZWN0b3IiLCJ1c2VyRGVzY3JpcHRpb25TZWxlY3RvciIsIl91c2VyTmFtZUVsZW1lbnQiLCJfdXNlckRlc2NyaXB0aW9uRWxlbWVudCIsInNldFVzZXJJbmZvIiwidGl0bGUiLCJfaW1hZ2VFbGVtZW50IiwiX2ltYWdlQ2FwdGlvbiIsIm9wZW4iLCJzcmMiLCJhbHQiLCJjYXJkU2VjdGlvbiIsImNvbnRhaW5lclNlbGVjdG9yIiwiaXRlbXMiLCJyZW5kZXJlciIsIl9yZW5kZXJlciIsIl9jb250YWluZXIiLCJyZW5kZXJJdGVtcyIsIml0ZW0iLCJhZGRJdGVtIiwiZWxlbWVudCIsInByZXBlbmQiLCJyZW5kZXJDYXJkIiwiYWRkRm9ybUVsIiwiZWRpdEZvcm1WYWxpZGF0b3IiLCJGb3JtVmFsaWRhdG9yIiwiYWRkRm9ybVZhbGlkYXRvciIsImRhdGEiLCJhZGRGb3JtUG9wdXAiLCJjcmVhdGVDYXJkIiwiZ2V0VmlldyIsImNhcmQiLCJjb250YWluZXIiLCJyZXZlcnNlIiwiY2FyZERhdGEiLCJhZGRDbG9zZUJ1dHRvbiIsImNhcmRTZWxlY3RvciIsImhhbmRsZUltYWdlQ2xpY2siLCJfbmFtZSIsIl9saW5rIiwiX2NhcmRTZWxlY3RvciIsIl9oYW5kbGVJbWFnZUNsaWNrIiwiX2VsZW1lbnQiLCJfaGFuZGxlTGlrZUJ1dHRvbiIsIl9oYW5kbGVEZWxldGVDYXJkIiwidG9nZ2xlIiwiX2dldFRlbXBsYXRlIiwiY29udGVudCIsImNsb25lTm9kZSIsImltYWdlRWxlbWVudCJdLCJzb3VyY2VSb290IjoiIn0=